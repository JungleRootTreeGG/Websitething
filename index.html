<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Shipping Ordering System</title>
<style>
body { 
  margin:0; 
  font-family: system-ui, sans-serif; 
  background:#f5f5f5; 
}

iframe { 
  width: 100%; 
  height: 500px; 
  border: none; 
  display:block;
}

.order-section {
  padding: 20px;
  max-width: 800px;
  margin: 20px auto;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.order-section h2 { margin-top:0; }

.order-section form label { display:block; margin-bottom: 10px; }

.order-section form input, 
.order-section form select {
  width: 100%;
  padding: 6px 10px;
  border-radius: 6px;
  border: 1px solid #ccc;
}

.order-section form button {
  margin-top: 15px;
  padding: 10px 20px;
  border:none;
  border-radius: 6px;
  background:#00bcd4;
  color:#fff;
  font-size:16px;
  cursor:pointer;
}

.order-section form button:hover { background:#0098aa; }
</style>
</head>
<body>

<iframe src="map.html" id="mapFrame"></iframe>

<div class="order-section">
  <h2>Place Your Shipping Order</h2>
  <form id="orderForm">
    <label>From Port:
      <input type="text" id="fromPort" readonly>
    </label>

    <label>To Port:
      <input type="text" id="toPort" readonly>
    </label>

    <label>Discord Username:
      <input type="text" id="discord">
    </label>

    <label>In-game Username:
      <input type="text" id="ingame">
    </label>

    <label>Cargo Value ($):
      <input type="number" id="cargoValue" min="0" value="0">
    </label>

    <label>Container Type:
      <select id="containerType">
        <option>Standard</option>
        <option>Refrigerated</option>
        <option>Hazardous</option>
      </select>
    </label>

    <label>Container Number:
      <input type="text" id="containerNumber">
    </label>

    <label>Total Price ($):
      <input type="text" id="totalPrice" readonly>
    </label>

    <button type="submit">Submit Order</button>
  </form>
</div>

<script>
const perStopFee = 1000;
let routePortNames = [];

// Listen for messages from the map iframe
window.addEventListener('message', (event) => {
  const data = event.data;
  if(data && data.startPort && data.endPort && Array.isArray(data.portsAlongRoute)){
    routePortNames = data.portsAlongRoute;
    document.getElementById('fromPort').value = data.startPort;
    document.getElementById('toPort').value = data.endPort;
    calculatePrice();
  }
});

function calculatePrice(){
  const cargoValue = parseFloat(document.getElementById('cargoValue').value) || 0;
  const stops = routePortNames.length || 0;
  const totalPrice = stops*perStopFee + cargoValue*0.1;
  document.getElementById('totalPrice').value = totalPrice.toFixed(2);
}

document.getElementById('cargoValue').addEventListener('input', calculatePrice);

// Optional form submit
document.getElementById('orderForm').addEventListener('submit', (e)=>{
  e.preventDefault();
  alert(`Order submitted!\nFrom: ${document.getElementById('fromPort').value}\nTo: ${document.getElementById('toPort').value}\nTotal Price: $${document.getElementById('totalPrice').value}`);
});
</script>

</body>
</html>
