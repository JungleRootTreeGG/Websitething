<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SMC Shipping Ordering System</title>

<style>
/* ===== GLOBAL ===== */
body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: linear-gradient(180deg, #0f1720, #121212);
  color: #eaeaea;
}

/* ===== MAP ===== */
iframe {
  width: 100%;
  height: 500px;
  border: none;
  display: block;
  background: #000;
}

/* ===== ORDER CARD ===== */
.order-section {
  max-width: 900px;
  margin: 24px auto;
  padding: 24px;
  background: #1b1f26;
  border-radius: 14px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.6);
}

.order-section h2 {
  margin-top: 0;
  color: #00c8e0;
}

/* ===== FORM ===== */
form label {
  display: block;
  margin-bottom: 12px;
}

form input,
form select,
form textarea {
  width: 95%;
  padding: 8px 12px;
  border-radius: 8px;
  border: 1px solid #3a3f46;
  background: #262b33;
  color: #fff;
}

form textarea {
  resize: vertical;
}

form small {
  display: block;
  font-size: 0.85em;
  color: #a0a7b0;
  margin-bottom: 12px;
}

form button {
  margin-top: 16px;
  padding: 12px 24px;
  border: none;
  border-radius: 8px;
  background: #00c8e0;
  color: #000;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
}

form button:hover {
  background: #00a6bb;
}

/* ===== CONTAINER INFO ===== */
.container-info {
  margin-top: 28px;
  padding: 18px;
  background: #222833;
  border-radius: 10px;
  border: 1px solid #343b46;
}

.container-info h3 {
  margin-top: 0;
  color: #00c8e0;
}

.container-info ul {
  padding-left: 20px;
}

.container-info img {
  max-width: 100%;
  margin-top: 12px;
  border-radius: 8px;
  border: 1px solid #333;
}
</style>
</head>

<body>

<!-- MAP -->
<iframe src="map.html" id="mapFrame" loading="eager"></iframe>

<!-- ORDER FORM -->
<div class="order-section">
  <h2>Place Your Shipping Order</h2>

  <form id="orderForm">

    <label>From Port:
      <input type="text" id="fromPort" readonly required>
    </label>

    <label>To Port:
      <input type="text" id="toPort" readonly required>
    </label>

    <label>Discord Username:
      <input type="text" id="discord" required>
    </label>

    <label>In-game Username:
      <input type="text" id="ingame" required>
    </label>

    <label>Cargo Value ($):
      <input type="number" id="cargoValue" min="0" value="0" required>
    </label>

    <label>Container Type:
      <select id="containerType" required>
        <option value="Civilian">Civilian</option>
        <option value="Military">Military</option>
      </select>
    </label>

    <div id="militaryNationContainer" style="display:none;">
      <label>Nation:
        <input type="text" id="militaryNation">
      </label>
    </div>

    <label>Container Number:
      <input type="text" id="containerNumber" placeholder="NBO 1234"
             required pattern="[A-Z]{3} \d{4}">
    </label>
    <small>Format: 3 capital letters + space + 4 digits (e.g. NBO 1234)</small>

    <label>Optional Comment:
      <textarea id="orderComment" rows="3"
                placeholder="Anything we should know?"></textarea>
    </label>

    <label>Total Price ($):
      <input type="text" id="totalPrice" readonly>
    </label>

    <button type="submit" id="submitBtn">Submit Order</button>
  </form>

  <!-- CONTAINER RULES -->
  <div class="container-info">
    <h3>Container Requirements</h3>
    <ul>
      <li>10 blocks long × 3 blocks wide × 5 blocks high</li>
      <li>Maximum 9 barrels or chests inside</li>
      <li>Iron door with lever inside (sealed for transport)</li>
      <li>Sign inside showing container number, origin & destination</li>
    </ul>

    <img src="https://i.postimg.cc/D0fp4QVg/3e88a5dc-5e2c-4157-af89-b859171ddbb0.png" loading="lazy">
    <img src="https://i.postimg.cc/rwRn4Fbp/6877b029-e017-49bf-aa81-0be269b7a1d1.png" loading="lazy">
    <img src="https://i.postimg.cc/5N6nc2fN/cd0a5ad6-4455-431d-925a-39826f16dbf8.png" loading="lazy">
  </div>
</div>

<script>
/* ===== ROUTE PRICING (EDIT HERE) ===== */
const routePrices = {
  "Miami→London": 5000,
  "Miami→Konigsberg": 8000,
  "London→Konigsberg": 3500
};

let routePortNames = [];

/* ===== MILITARY TOGGLE ===== */
const containerTypeSelect = document.getElementById('containerType');
const militaryNationContainer = document.getElementById('militaryNationContainer');

containerTypeSelect.addEventListener('change', () => {
  militaryNationContainer.style.display =
    containerTypeSelect.value === "Military" ? "block" : "none";
  calculatePrice();
});

/* ===== MAP MESSAGE ===== */
window.addEventListener('message', (event) => {
  const d = event.data;
  if (d?.startPort && d?.endPort && Array.isArray(d.portsAlongRoute)) {
    routePortNames = d.portsAlongRoute;
    fromPort.value = d.startPort;
    toPort.value = d.endPort;
    calculatePrice();
  }
});

/* ===== PRICE CALC ===== */
function calculatePrice() {
  const cargoValue = Number(cargoValueInput.value) || 0;
  const routeKey = `${fromPort.value}→${toPort.value}`;
  const routeCost = routePrices[routeKey] || 0;
  totalPrice.value = (routeCost + cargoValue * 0.10).toFixed(2);
}

const cargoValueInput = document.getElementById('cargoValue');
const fromPort = document.getElementById('fromPort');
const toPort = document.getElementById('toPort');
const totalPrice = document.getElementById('totalPrice');

cargoValueInput.addEventListener('input', calculatePrice);

/* ===== SUBMIT ===== */
document.getElementById('orderForm').addEventListener('submit', async (e) => {
  e.preventDefault();

  if (!routePortNames.length) {
    alert("Select a route on the map first.");
    return;
  }

  alert("Order submitted successfully.");
});
</script>

</body>
</html>
