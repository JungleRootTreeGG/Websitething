<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <title>Earth Shipping Routes - Layers Edition</title>

  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    crossorigin=""
  />

  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      background: #050814;
      color: #f5f5f5;
      font-family: sans-serif;
    }

    #map {
      height: 100vh;
      width: 100vw;
    }

    .leaflet-container {
      background: #000;
    }
  </style>
</head>
<body>

<div id="map"></div>

<script
  src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  crossorigin=""
></script>

<script>
  /* =========================
     1. CONFIGURATIE & KAART
     ========================= */
  const IMG_URL = './assets/world.png';
  const IMG_WIDTH = 1005;
  const IMG_HEIGHT = 500;

  const map = L.map('map', {
    crs: L.CRS.Simple, // Gebruik simpel CRS voor pixel-plaatsing
    minZoom: -1,
    maxZoom: 2
  });

  const bounds = [, [IMG_HEIGHT, IMG_WIDTH]];
  L.imageOverlay(IMG_URL, bounds).addTo(map);
  map.fitBounds(bounds);

  /* =========================
     2. HAVEN DATA (Pixel Posities)
     ========================= */
  // De structuur is [Y (van bovenaf), X (van linksaf)]
  const ports = [
    { name: 'Amsterdam',   pos: }, // Klik-hulp nodig
    { name: 'Rotterdam',   pos: }, // Klik-hulp nodig
    { name: 'London',      pos: }, // Jouw coördinaat
    { name: 'Florida',     pos: }, // Jouw coördinaat
    { name: 'New York',    pos: }, // Klik-hulp nodig
    { name: 'Los Angeles', pos: }, // Klik-hulp nodig
    { name: 'Singapore',   pos: }  // Klik-hulp nodig
  ];

  /* =========================
     3. ROUTE LAYERS (De Tekeningen)
     ========================= */
  // Definieer hier de exacte routes als lijsten met pixelpunten [Y, X]
  const routeData = {
    'Florida-London': [
        ports.find(p => p.name === 'Florida').pos,
       , // Gebruik klik-hulp om punten in de oceaan te bepalen
       , // Plak hier de [Y, X] waarden (bijv. [400, 150])
       ,
        ports.find(p => p.name === 'London').pos
    ],
    'Amsterdam-New York': [], // Nog in te vullen
    'London-New York': []     // Nog in te vullen
  };

  /* =========================
     4. LOGICA & INTERACTIE
     ========================= */
  const portMarkers = {};
  let selectedPorts = [];
  let currentRouteLayer = null;

  function createPortIcon(selected) {
    return L.icon({
      iconUrl: './assets/anchor.png',
      iconSize: selected ? : [42, 42],
      iconAnchor:
    });
  }

  ports.forEach(port => {
    // Plaats alleen markers als de positie is ingevuld (niet leeg [])
    if (port.pos.length === 2) { 
        const marker = L.marker(port.pos, {
          icon: createPortIcon(false),
          title: port.name
        }).addTo(map);

        portMarkers[port.name] = marker;
        marker.on('click', () => handlePortClick(port));
    }
  });

  function handlePortClick(port) {
    if (selectedPorts.some(p => p.name === port.name)) return;
    selectedPorts.push(port);
    if (selectedPorts.length > 2) selectedPorts.shift();
    updateRoute();
  }

  function updateRoute() {
    if (currentRouteLayer) {
      map.removeLayer(currentRouteLayer);
      currentRouteLayer = null;
    }

    if (selectedPorts.length < 2) return;

    const start = selectedPorts[0];
    const end = selectedPorts[1];
    
    // Zoek de route in beide richtingen (bijv. Florida-London of London-Florida)
    const path = routeData[`${start.name}-${end.name}`] || routeData[`${end.name}-${start.name}`];

    if (path) {
      currentRouteLayer = L.polyline(path, {
        color: '#00bcd4',
        weight: 4,
        opacity: 0.9
      }).addTo(map);

      map.fitBounds(currentRouteLayer.getBounds(), { padding: });
    } else {
        console.log(`Geen gedefinieerde route layer gevonden voor ${start.name} en ${end.name}.`);
    }
  }

  /* =========================
     5. KLIK-HULP (Voor jou om in te vullen)
     ========================= */
  map.on('click', function(e) {
    const y = Math.round(e.latlng.lat);
    const x = Math.round(e.latlng.lng);
    console.log(`Geklikte pixel locatie: [${y}, ${x}]`);
  });
</script>

</body>
</html>
